# Function API Calling

CLI‚Äë—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ —Å—Ö–µ–º —á–µ—Ä–µ–∑ **OpenRouter API**.  
–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏–∑ YAML, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ CI.

---

## üìë –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ `.py` —Ñ–∞–π–ª–æ–≤ –∏ —Å—Ö–µ–º –∏–∑ `.json`.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∏ —Å—Ö–µ–º—ã (`Validator`).
- –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏–∑ YAML suite (`--tests`).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ü–µ–ø–æ—á–µ–∫ –≤—ã–∑–æ–≤–æ–≤ (`tool_calls` –∏ `function_call`).
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤:
  - –ª–æ–∫–∞–ª—å–Ω–æ (—á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å),
  - –≤ CI (JSON‚Äë–æ—Ç—á—ë—Ç –¥–ª—è GitHub Actions).

---

## üõ†Ô∏è –°—Ç–µ–∫
- Python 3.12+
- OpenRouter API / OpenAI SDK
- YAML –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- rich ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥
- black, ruff ‚Äî –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç –∏ –ª–∏–Ω—Ç–∏–Ω–≥

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–ó–∞–≥–ª—É—à–∫–∞)

```bash
python test_runner.py --function functions/weather.py --schema functions/weather.json --tests suites/weather.yaml
üì• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è: weather

üîç –¢–µ—Å—Ç 1/3: '–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–∏–Ω—Å–∫–µ?'
‚û°Ô∏è –í—ã–∑–æ–≤ 1: weather({'city': 'Minsk'})
‚öôÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç weather: {"temperature": 0, "condition": "unknown"}

üîç –¢–µ—Å—Ç 2/3: '–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ë—Ä–µ—Å—Ç–µ?'
‚û°Ô∏è –í—ã–∑–æ–≤ 1: weather({'city': 'Brest'})
‚öôÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç weather: {"temperature": 0, "condition": "unknown"}

üîç –¢–µ—Å—Ç 3/3: '–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ì—Ä–æ–¥–Ω–æ?'
‚û°Ô∏è –í—ã–∑–æ–≤ 1: weather({'city': '–ì—Ä–æ–¥–Ω–æ'})
‚öôÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç weather: {"temperature": 0, "condition": "unknown"}
                                   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÉ –¢–µ—Å—Ç ‚îÉ –§—É–Ω–∫—Ü–∏—è ‚îÉ –ó–∞–ø—Ä–æ—Å                 ‚îÉ –†–µ–∑—É–ª—å—Ç–∞—Ç                                  ‚îÉ
‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
‚îÇ    1 ‚îÇ weather ‚îÇ –ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–∏–Ω—Å–∫–µ? ‚îÇ {"temperature": 0, "condition": "unknown"} ‚îÇ
‚îÇ    2 ‚îÇ weather ‚îÇ –ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ë—Ä–µ—Å—Ç–µ? ‚îÇ {"temperature": 0, "condition": "unknown"} ‚îÇ
‚îÇ    3 ‚îÇ weather ‚îÇ –ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ì—Ä–æ–¥–Ω–æ? ‚îÇ {"temperature": 0, "condition": "unknown"} ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è suite.yaml
```yaml
- query: "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–∏–Ω—Å–∫–µ?"
  description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ weather –¥–ª—è –≥–æ—Ä–æ–¥–∞ –ú–∏–Ω—Å–∫"

- query: "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ë—Ä–µ—Å—Ç–µ?"
  description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ weather –¥–ª—è –≥–æ—Ä–æ–¥–∞ –ë—Ä–µ—Å—Ç"

- query: "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ì—Ä–æ–¥–Ω–æ?"
  description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ weather –¥–ª—è –≥–æ—Ä–æ–¥–∞ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö"
```

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è function.py
```python
def weather(arguments: dict) -> str: ...
```

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è schema.json
```json
{
  "name": "weather",
  "description": "–ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞",
  "parameters": {
    "type": "object",
    "properties": {
      "city": {
        "type": "string",
        "description": "–ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞"
      }
    },
    "required": ["city"]
  }
}
```

## üìä CI/CD (Docker + GitHub Actions)
–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ CI —á–µ—Ä–µ–∑ Docker‚Äë–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ê ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—é –∏ –µ—ë —Å—Ö–µ–º—É (.py + .json + .yaml).

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π B ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç Dockerfile –∏ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ (—ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç).

Workflow:

–°–æ–±–∏—Ä–∞–µ—Ç Docker‚Äë–æ–±—Ä–∞–∑ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è B.

–ú–æ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ê –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

–ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ (--function, --schema, --tests).

–ü—Ä–æ–≥–æ–Ω—è–µ—Ç —Ç–µ—Å—Ç—ã, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç (LocalReporter –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏–ª–∏ CIReporter –¥–ª—è GitHub Actions).

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã CI/CD (test_results.json) –∏–ª–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å.

Workflow –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ê
–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .github/workflows/run-tests.yml:
```yml
name: Run Function Tests

on:
  workflow_dispatch:   # –∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é –∏–∑ GitHub

jobs:
  call-tests:
    uses: Smaipl/Tests-Function-Api-Calling-OpenAi/.github/workflows/test_functions_on_model.yml@main
    with:
      function_name: "–∏–º—è_—Ñ—É–Ω–∫—Ü–∏–∏_–±–µ–∑_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è"
    secrets:
      OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
```